<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <title>Trust in me, just in me</title>
    <style>
      body {
        min-height: 100%;
        margin: 0;
        display: flex;
        flex-direction: column;
      }
      iframe {
        flex-grow: 1;
      }
    </style>
  </head>

  <body>
    <p>
      This
      <a href="https://gph.is/g/aXLmyvR" target="_blank">trusted</a> website
      only renders websites that enforce
      <code
        >default-src 'none'; sandbox allow-scripts; script-src 'unsafe-inline';
        style-src 'unsafe-inline';</code
      >
      as a CSP, preventing them from leaking sensitive data.
    </p>
    <form id="url-form">
      <label for="url">URL to load:</label>
      <input
        type="text"
        id="url"
        name="url"
        required
        value="https://csp-locked-client-side-base64.web.app/"
      />
      <button type="submit">Load</button>
    </form>
    <iframe
      id="csp-iframe"
      sandbox="allow-scripts"
      csp="default-src 'none'; sandbox allow-scripts; script-src 'unsafe-inline';
      style-src 'unsafe-inline';"
    ></iframe>
    <script type="module">
      function handleSubmit() {
        event.preventDefault()

        const url = document.getElementById('url').value
        console.log(url)
        document.getElementById('csp-iframe').setAttribute('src', url)
      }

      document
        .getElementById('url-form')
        .addEventListener('submit', handleSubmit)
    </script>
  </body>
</html>
